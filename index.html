<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinanceMGT</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js for Dashboard Charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1f2937; }
        ::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #6b7280; }
        .hidden { display: none; }
    </style>
    <script>
        // Configuration for Tailwind CSS dark mode
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 font-sans">

    <!-- App Container -->
    <div id="app-container" class="hidden h-screen">
        <!-- Sidebar -->
        <aside id="sidebar" class="absolute lg:relative z-30 w-64 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 h-full shadow-xl transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out flex flex-col">
            <div class="p-6 flex items-center justify-between">
                <h1 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-teal-400">FinanceMGT</h1>
                <button id="close-sidebar-btn" class="lg:hidden text-gray-500 dark:text-gray-400">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <nav id="nav-menu" class="flex-1 px-4">
                <!-- Nav items will be dynamically inserted here -->
            </nav>
            <div class="p-4 border-t border-gray-200 dark:border-gray-700">
                <a href="#" class="nav-item flex items-center px-4 py-3 my-1 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700">
                    <i data-lucide="settings"></i><span class="ml-4 font-medium">Settings</span>
                </a>
                <a href="#" id="logout-btn" class="nav-item flex items-center px-4 py-3 my-1 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700">
                    <i data-lucide="log-out"></i><span class="ml-4 font-medium">Log Out</span>
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <header class="flex items-center justify-between p-4 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700">
                <button id="open-sidebar-btn" class="lg:hidden text-gray-600 dark:text-gray-300">
                    <i data-lucide="menu"></i>
                </button>
                <div class="flex-1"></div>
                <div class="flex items-center space-x-4">
                    <button id="theme-toggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                        <i data-lucide="sun" class="block dark:hidden"></i>
                        <i data-lucide="moon" class="hidden dark:block"></i>
                    </button>
                </div>
            </header>
            <main id="main-content" class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 dark:bg-gray-900 p-4 sm:p-6 lg:p-8">
                <!-- Page content will be dynamically inserted here -->
            </main>
        </div>
    </div>

    <!-- Landing Page -->
    <div id="landing-page" class="min-h-screen flex flex-col items-center justify-center bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 p-4 transition-colors duration-500">
        <div class="absolute top-4 right-4">
            <button id="landing-theme-toggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                <i data-lucide="sun" class="block dark:hidden"></i>
                <i data-lucide="moon" class="hidden dark:block"></i>
            </button>
        </div>
        <div class="text-center z-10">
            <h1 class="text-5xl md:text-7xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-teal-400 mb-4">
                FinanceMGT
            </h1>
            <p class="text-lg md:text-xl text-gray-600 dark:text-gray-400 max-w-2xl mx-auto mb-8">
                Your intelligent financial co-pilot. Track income, manage budgets, and allocate funds with precision.
            </p>
            <button id="enter-dashboard-btn" class="bg-gradient-to-r from-blue-500 to-teal-400 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 ease-in-out">
                Enter Dashboard
            </button>
        </div>
        <div class="absolute inset-0 bg-[radial-gradient(circle_500px_at_50%_200px,#3b82f622,transparent)] -z-1"></div>
    </div>

    <!-- Modal Container -->
    <div id="modal-container" class="hidden fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4 transition-opacity">
        <!-- Modal content will be dynamically inserted here -->
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- STATE MANAGEMENT (DATA) ---
    let state = {
        incomeSources: [
            { id: 1, name: 'Monthly Salary', amount: 3800, type: 'Primary' },
            { id: 2, name: 'Freelance Project', amount: 650, type: 'Side Hustle' },
        ],
        budgets: [
            { id: 1, name: 'Rent', category: 'Housing', amount: 1450, dueDate: '2024-08-01', status: 'Paid' },
            { id: 2, name: 'Council Tax', category: 'Housing', amount: 180, dueDate: '2024-08-05', status: 'Paid' },
            { id: 3, name: 'Groceries', category: 'Groceries', amount: 400, dueDate: 'N/A', status: 'Ongoing' },
        ],
        subscriptions: [
            { id: 1, name: 'Netflix', amount: 13.99, billingCycle: 'Monthly', nextPayment: '2024-08-15' },
            { id: 2, name: 'Spotify', amount: 10.99, billingCycle: 'Monthly', nextPayment: '2024-08-11' },
        ],
        overtime: [
            { id: 1, date: '2024-07-20', time: '18:00 - 22:00', amount: 120, allocation: 'Vacation Fund', status: 'Completed' },
            { id: 2, date: '2024-07-28', time: '20:00 - 23:00', amount: 70, allocation: 'Vacation Fund', status: 'Not Started' },
        ],
        activePage: 'dashboard',
    };

    // --- UTILITY FUNCTIONS ---
    const formatCurrency = (amount) => new Intl.NumberFormat('en-GB', { style: 'currency', currency: 'GBP' }).format(amount);
    const getIcon = (name, classes = "w-5 h-5") => `<i data-lucide="${name}" class="${classes}"></i>`;
    const categoryIcons = {
        'Groceries': 'shopping-cart', 'Utilities': 'zap', 'Transport': 'car', 'Housing': 'home',
        'Entertainment': 'film', 'Health': 'heart', 'Subscriptions': 'repeat', 'Income': 'dollar-sign',
        'Personal Care': 'heart', 'Debt': 'credit-card', 'Savings': 'trending-up', 'Other': 'book-open',
    };

    // --- TEMPLATES (HTML GENERATORS) ---
    const mainContent = document.getElementById('main-content');
    const modalContainer = document.getElementById('modal-container');
    const navMenu = document.getElementById('nav-menu');

    const navItems = [
        { id: 'dashboard', label: 'Dashboard', icon: 'trending-up' },
        { id: 'income', label: 'Income', icon: 'dollar-sign' },
        { id: 'budget', label: 'Budgets', icon: 'shopping-cart' },
        { id: 'subscriptions', label: 'Subscriptions', icon: 'repeat' },
        { id: 'overtime', label: 'Overtime', icon: 'clock' },
    ];

    // --- RENDER FUNCTIONS ---
    function renderNav() {
        navMenu.innerHTML = navItems.map(item => `
            <a href="#" data-page="${item.id}" class="nav-item flex items-center px-4 py-3 my-1 rounded-lg transition-colors duration-200 ${state.activePage === item.id ? 'bg-blue-500 text-white shadow-md' : 'text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700'}">
                ${getIcon(item.icon)}
                <span class="ml-4 font-medium">${item.label}</span>
            </a>
        `).join('');
    }

    function renderPage() {
        switch (state.activePage) {
            case 'dashboard': renderDashboard(); break;
            case 'income': renderIncomePage(); break;
            case 'budget': renderBudgetPage(); break;
            case 'subscriptions': renderSubscriptionsPage(); break;
            case 'overtime': renderOvertimePage(); break;
        }
        lucide.createIcons();
        renderNav();
    }
    
    // --- RENDER DASHBOARD ---
    function renderDashboard() {
        const primaryIncome = state.incomeSources.reduce((sum, i) => sum + i.amount, 0);
        const overtimeIncome = state.overtime.reduce((sum, o) => sum + o.amount, 0);
        const totalIncome = primaryIncome + overtimeIncome;
        const totalBudgeted = state.budgets.reduce((sum, b) => sum + b.amount, 0);
        const totalSubscriptionCost = state.subscriptions.reduce((sum, s) => sum + s.amount, 0);
        const totalExpenses = totalBudgeted + totalSubscriptionCost;
        const balance = totalIncome - totalExpenses;

        mainContent.innerHTML = `
            <div class="space-y-6">
                <h2 class="text-3xl font-bold text-gray-800 dark:text-gray-200">Dashboard</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-gradient-to-br from-blue-500 to-indigo-600 text-white p-6 rounded-xl shadow-lg">
                        <div class="flex justify-between items-start"><div><p class="text-sm font-medium opacity-80">Net Balance</p><p class="text-3xl font-bold">${formatCurrency(balance)}</p></div><div class="p-3 bg-white/20 rounded-lg">${getIcon('dollar-sign', 'w-6 h-6')}</div></div>
                    </div>
                    <div class="bg-gradient-to-br from-green-500 to-emerald-600 text-white p-6 rounded-xl shadow-lg">
                        <div class="flex justify-between items-start"><div><p class="text-sm font-medium opacity-80">Total Income</p><p class="text-3xl font-bold">${formatCurrency(totalIncome)}</p></div><div class="p-3 bg-white/20 rounded-lg">${getIcon('trending-up', 'w-6 h-6')}</div></div>
                    </div>
                    <div class="bg-gradient-to-br from-red-500 to-rose-600 text-white p-6 rounded-xl shadow-lg">
                        <div class="flex justify-between items-start"><div><p class="text-sm font-medium opacity-80">Total Expenses</p><p class="text-3xl font-bold">${formatCurrency(totalExpenses)}</p></div><div class="p-3 bg-white/20 rounded-lg">${getIcon('trending-down', 'w-6 h-6')}</div></div>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                        <h3 class="font-semibold text-lg text-gray-800 dark:text-gray-200 mb-4">Expense Composition</h3>
                        <canvas id="expenseChart"></canvas>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md">
                            <h3 class="font-semibold text-lg text-gray-800 dark:text-gray-200 mb-4">Total Overtime Earned</h3>
                            <p class="text-3xl font-bold text-gray-800 dark:text-gray-200">${formatCurrency(overtimeIncome)}</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">from ${state.overtime.length} shifts</p>
                            <button data-page="overtime" class="nav-item w-full flex items-center justify-center bg-blue-500 text-white px-4 py-2 rounded-lg shadow-md hover:bg-blue-600 transition-colors">Manage Overtime ${getIcon('arrow-right', 'w-4 h-4 ml-2')}</button>
                        </div>
                    </div>
                </div>
            </div>`;
        
        // Chart.js rendering
        const ctx = document.getElementById('expenseChart').getContext('2d');
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['Budget Items', 'Subscriptions'],
                datasets: [{
                    data: [totalBudgeted, totalSubscriptionCost],
                    backgroundColor: ['#4f46e5', '#818cf8'],
                    borderColor: document.documentElement.classList.contains('dark') ? '#1f2937' : '#fff',
                    borderWidth: 2,
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                           color: document.documentElement.classList.contains('dark') ? '#d1d5db' : '#374151',
                        }
                    },
                }
            }
        });
    }

    // --- RENDER OTHER PAGES (INCOME, BUDGETS, ETC.) ---
    // Each function will be similar: build an HTML string and set mainContent.innerHTML
    // For brevity in this example, I'll show the structure for one page.
    
    function renderIncomePage() {
        const totalIncome = state.incomeSources.reduce((sum, i) => sum + i.amount, 0);
        mainContent.innerHTML = `
            <div class="space-y-6">
                <div class="flex justify-between items-center">
                    <h2 class="text-3xl font-bold text-gray-800 dark:text-gray-200">Income Sources</h2>
                    <button id="add-income-btn" class="flex items-center bg-blue-500 text-white px-4 py-2 rounded-lg shadow-md hover:bg-blue-600 transition-colors">${getIcon('plus-circle', 'w-5 h-5 mr-2')} Add Income</button>
                </div>
                <div class="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-md">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead>
                                <tr class="border-b border-gray-200 dark:border-gray-700">
                                    <th class="p-3 text-sm font-semibold text-gray-500 dark:text-gray-400">Source</th>
                                    <th class="p-3 text-sm font-semibold text-gray-500 dark:text-gray-400">Type</th>
                                    <th class="p-3 text-sm font-semibold text-gray-500 dark:text-gray-400 text-right">Amount</th>
                                    <th class="p-3 text-sm font-semibold text-gray-500 dark:text-gray-400 text-right">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="income-table-body">
                                ${state.incomeSources.map(source => `
                                    <tr class="border-b border-gray-200 dark:border-gray-700 last:border-0">
                                        <td class="p-3 font-medium text-gray-800 dark:text-gray-200">${source.name}</td>
                                        <td class="p-3"><span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300">${source.type}</span></td>
                                        <td class="p-3 text-right font-semibold text-green-500">${formatCurrency(source.amount)}</td>
                                        <td class="p-3 text-right">
                                            <div class="flex justify-end items-center space-x-2">
                                                <button data-id="${source.id}" class="edit-btn p-2 text-gray-500 hover:text-blue-500 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">${getIcon('pencil', 'w-4 h-4')}</button>
                                                <button data-id="${source.id}" class="delete-btn p-2 text-gray-500 hover:text-red-500 dark:hover:text-red-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">${getIcon('trash-2', 'w-4 h-4')}</button>
                                            </div>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                            <tfoot class="border-t-2 border-gray-200 dark:border-gray-700">
                                <tr>
                                    <td colspan="3" class="p-3 font-bold text-gray-800 dark:text-gray-200">Total Monthly Income</td>
                                    <td class="p-3 text-right font-bold text-lg text-green-500">${formatCurrency(totalIncome)}</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>`;
    }
    
    // Placeholder for other page render functions (Budget, Subscriptions, Overtime)
    function renderBudgetPage() { mainContent.innerHTML = `<div>Budget Page Content</div>`; }
    function renderSubscriptionsPage() { mainContent.innerHTML = `<div>Subscriptions Page Content</div>`; }
    function renderOvertimePage() { mainContent.innerHTML = `<div>Overtime Page Content</div>`; }


    // --- EVENT LISTENERS ---
    
    // Theme Toggling
    function handleThemeToggle() {
        document.documentElement.classList.toggle('dark');
    }
    document.getElementById('theme-toggle').addEventListener('click', handleThemeToggle);
    document.getElementById('landing-theme-toggle').addEventListener('click', handleThemeToggle);

    // Page Navigation
    document.body.addEventListener('click', (e) => {
        const navItem = e.target.closest('.nav-item');
        if (navItem && navItem.dataset.page) {
            e.preventDefault();
            state.activePage = navItem.dataset.page;
            renderPage();
            document.getElementById('sidebar').classList.add('-translate-x-full');
        }
    });
    
    // Sidebar Toggle
    document.getElementById('open-sidebar-btn').addEventListener('click', () => {
        document.getElementById('sidebar').classList.remove('-translate-x-full');
    });
    document.getElementById('close-sidebar-btn').addEventListener('click', () => {
        document.getElementById('sidebar').classList.add('-translate-x-full');
    });

    // App Entry / Exit
    document.getElementById('enter-dashboard-btn').addEventListener('click', () => {
        document.getElementById('landing-page').classList.add('hidden');
        document.getElementById('app-container').style.display = 'flex';
        renderPage();
    });
    document.getElementById('logout-btn').addEventListener('click', (e) => {
        e.preventDefault();
        document.getElementById('landing-page').classList.remove('hidden');
        document.getElementById('app-container').style.display = 'none';
    });
    
    // Generic CRUD event listeners using event delegation
    mainContent.addEventListener('click', e => {
        const addBtnId = e.target.closest('button')?.id;
        const editBtn = e.target.closest('.edit-btn');
        const deleteBtn = e.target.closest('.delete-btn');

        if (addBtnId === 'add-income-btn') {
            // Logic to show Add Income Modal
            alert('Add Income functionality not fully implemented in this example.');
        } else if (editBtn) {
            const id = editBtn.dataset.id;
            // Logic to find item by ID and show Edit Modal
            alert(`Edit item with ID: ${id}`);
        } else if (deleteBtn) {
            const id = deleteBtn.dataset.id;
            // Logic to show Delete Confirmation Modal
            if (confirm('Are you sure you want to delete this item?')) {
                // Logic to delete item from state and re-render
                alert(`Deleted item with ID: ${id}`);
            }
        }
    });

    // --- INITIAL RENDER ---
    // This is a simplified version. A full implementation would have render functions for all pages
    // and full modal logic for Add/Edit/Delete on each.
});
</script>

</body>
</html>
